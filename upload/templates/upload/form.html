<!DOCTYPE html>
<html lang="en">
<head>
      <title>thErudite</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">      
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.3/css/materialize.min.css">
      <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>           
      <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.3/js/materialize.min.js"></script> 
      <style>
   
    body{
      background-color: #193540;
      background-repeat: no-repeat;
    background-size: cover;
    }   
    .reg{
      margin-top: 2%;
      margin-bottom:50px;
    }
    .manthan{
      font-weight: bold;
      font-family: Hawaii 5-0, sans-serif;
      color: #193540;
    }
      </style>
   </head>
<!--<body>
{% if mail %}
    <div>Hi! {{name}}</div>
    <div style="height:25px;background-color: blue">{{mail}}</div>

{% endif %}      
<div id="login"> Login </div>
    
        <input type="file" id="file" name="file">
        <input type="submit" value="Submit">
    </form>
</body>-->
<body>
    <!--form starts here-->
    <div class="container reg">
    <div class="container">
          <div class="card-panel hoverable">
        <div id="registration-page" class="row">
            <form class="col s12" id="form">
            <div class="container">
              <div class="row">
                <div class="input-field col s12">
                  <p class="center-align manthan" style="font-size: 3em">thErudite</p>
                </div>
              </div>
              <div><p class="center-align manthan" style="font-size: 1.2em">Fill this out for better suggestions!</p></div>
            <div class="row"  >
                <div class="col s4" style="font-size: 1.2em;">Category</div>
                <br>
                <br>
                <div class="input-field col s12">
                  <select id='quota' style="color: #193540">
                  <option value="" disabled selected>Choose your option</option>
                  <option style="color: #193540" value="General">General</option>
                  <option style="color: #193540" value="SC">SC</option>
                  <option style="color: #193540" value="ST">ST</option>
                  <option style="color: #193540" value="BC">BC</option>
                  <option style="color: #193540" value="Others">Others</option>
                  </select>
                </div>
            </div>


            <div class="row" >
                <div class="col s6" style="font-size: 1.2em;">Family's Income:
                </div>
                <br>
                 <p id="ebp">
                  <input class="with-gap" name="group2" type="radio" id="test5" value="1,00,000" checked />
                  <label for="test5" style="color:black;"> < 1,00,000</label>
                  <input class="with-gap" name="group2" type="radio" id="test6" value="1,50,000" />
                  <label for="test6" style="color:black;"> < 1,50,000</label>
                  <input class="with-gap" name="group2" type="radio" id="test7" value="2,00,000"/>
                  <label for="test7" style="color:black;"> < 2,00,000</label>
                  <input class="with-gap" name="group2" type="radio" id="test8" value="2,50,000"/>
                  <label for="test8" style="color:black;"> < 2,00,000</label>

                </p>
      
        
             </div>

             <div class="row" >
                <div class="col s6" style="font-size: 1.2em;">Physically Handicapped
                </div>
                <br>
                 <p id="ph">
                  <input class="with-gap" value="yes" name="group22" type="radio" id="test12" checked />
                  <label for="test12" style="color:black;">YES</label>
                  <input class="with-gap" value="no" name="group22" type="radio" id="test13" checked />
                  <label for="test13" style="color:black;">NO</label>
                </p>
      
        
             </div>


                          
            <div class="row">
              <div class="input-field col s6">
                <input class="btn waves-effect waves-light col s12" style="background-color: #193540" type="submit" name="Submit">
              </div>
            </div>
            </div>
          </form>
      </div>
    </div>
    </div>
  </div>
  <!--form ends-->
   <!--script-->

<!--script-->
   </body>   
<script>
$(document).ready(function() {
    $('select').material_select();
  });


//alert('hello');

        function getCookie(name) {
            var cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                var cookies = document.cookie.split(';');
                for (var i = 0; i < cookies.length; i++) {
                    var cookie = jQuery.trim(cookies[i]);
                    // Does this cookie string begin with the name we want?
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            } 
            return cookieValue;
        }
        var csrftoken = getCookie('csrftoken');
        function csrfSafeMethod(method) {
            // these HTTP methods do not require CSRF protection
            return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
        }
        $.ajaxSetup({
            beforeSend: function(xhr, settings) {
                console.log(settings)
                if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                    console.log("HERE in ajax set-up")
                    xhr.setRequestHeader("X-CSRFToken", csrftoken);
                }
            }
        });
        $('#form').on('submit', function(ev){
            //console.log("Stopping event from propagation", ev)
            ev.preventDefault();
          //  alert('eht');
            var income="";
            var quota=document.getElementById('quota');
            var quota2=quota.options[quota.selectedIndex].value;
           // alert(quota2);
              if (document.getElementById('test5').checked){
                  income=document.getElementById('test5').value;
              }
              else if(document.getElementById('test6').checked){
                income=document.getElementById('test6').value;
              }
              else if(document.getElementById('test7').checked){
                income=document.getElementById('test7').value
              }
              else if(document.getElementById('test8').checked){
                income=document.getElementById('test8').value
              }
             // alert(income);

              var ph="";
              if (document.getElementById('test12').checked){
                  ph=document.getElementById('test12').value;
              }
              else if(document.getElementById('test13').checked){
                ph=document.getElementById('test13').value;
              }
              //alert(ph);
            //console.log("Sending Request ", csrftoken)
            //var fd = new FormData();
            //console.log(document.getElementById("file"))
            //console.log(document.getElementById('file').files[0])
            //fd.append('file', document.getElementById('file').files[0])
            //console.log(fd)
            $.ajax({
                url: 'http://localhost:8000/scholarship/getinfo/',
                method: 'POST',
                data : { csrfmiddlewaretoken : csrftoken,
                  category:quota2,
                  income:income,
                  ph:ph, 
                },
                //contentType: false,
                //processData: false,
                success : function(data){
                    alert("hey");
                window.location.href = "http://localhost:8000/scholarship/recommended/";
                 },
                 error : function(xhr,errmsg,err) {

                    console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
                    //console.log(csrftoken);
                 }
            })
        })
</script>
</html>